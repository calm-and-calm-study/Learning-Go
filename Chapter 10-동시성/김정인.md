# 동시성

---

- 동시성은 단일 프로세스를 독립적인 컴포넌트로 분리하고, 해당 컴포넌트가 안전하게 데이터를 공유하는 방법을 지정하는 컴퓨터 과학 용어
- 대부분 잠금을 획득하여 공유 데이터를 접근하는 운영체제 레벨 스레드를 사용하는 라이브러리를 통해 동시성을 제공한다.


- Go 는 순차적 프로세스들의 통신 (CSP) 에 기반한다.

<br />


## 동시성 사용 시점

- 동시성은 병렬성이지 않다.
- 모든 프로그램은 데이터를 받고, 데이터를 변환하여 결과를 출력하는 3단계의 절차를 수행한다.
- 동시성은 동시에 실행되는 것이 시간이 얼마 걸리지 않을 때 사용하는 것은 좋지 않다.

<br />







## 채널 대신에 뮤택스를 사용하는 경우

---

- 뮤텍스 : 상호 배제 (mutual exclusion) 의 약어
- 뮤택스는 공유된 데이터의 조각의 접근이나 어떤 코드의 동시 실행을 제한한다.
- 임계 영역 (critical section) 을 보호한다.

- 메모리를 공유하여 통신하지 말고, 통신을 통해 메모리를 공유하자.

<br />

## 채널과 뮤택스 사용의 결정을 도와주기위한 결정 트리

---

- Concurrency in Go 
  - 고루틴들을 조정하고나 고루틴에 의해 변경되는 값을 추적하는 경우에는 채널을 사용하자.
  - 구조체에 항목을 공유하여 접근하는 겨웅에는 뮤텍스를 사용하자.
  - 채널을 사용했을 때 중대한 성능의 문제를 발견했고, 어떤 다른 방법으로도 해당 이슈가 고쳐지지 않는 경우에는 뮤텍스를 사용하여 구현해보도록 하자.

<br />

## 뮤택스는 복사될 수 없다.

---

- sync.WaitGroup 과 sync.Once 와 같이 뮤텍스는 절대로 복사될 수 없다.
- 함수로 전달되거나 구조체의 항목으로 접근된다면 반드시 포인터를 통해야 한다.